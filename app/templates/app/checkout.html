{% extends 'app/base.html' %}
{% load static %}
{% block title %}Checkout{% endblock title %}
{% block main-content %}
<div class="container my-5">
  <div class="row g-4">
    
    <!-- Order Summary -->
    <div class="col-lg-6">
      <div class="card border-0 shadow-sm p-3">
        <h4 class="fw-semibold mb-3"><i class="bi bi-bag-check me-2"></i>Order Summary</h4>
        <hr>
        
        {% for cart in carts %}
        <div class="d-flex justify-content-between align-items-center border-bottom py-2">
          <div>
            <h6 class="mb-0">{{ cart.product.title }}</h6>
            <small class="text-muted">Qty: {{ cart.quantity }}</small>
          </div>
          <p class="mb-0 fw-semibold text-dark">₹{{ cart.product.discounted_price }}</p>
        </div>
        {% empty %}
        <p class="text-muted mt-2">Your cart is empty.</p>
        {% endfor %}
        
        <div class="pt-3">
          <div class="d-flex justify-content-between">
            <p class="mb-1">Subtotal</p>
            <p class="mb-1 fw-semibold">₹{{ amount }}</p>
          </div>
          <div class="d-flex justify-content-between">
            <p class="mb-1">Shipping</p>
            <p class="mb-1 fw-semibold">₹{{ shipping }}</p>
          </div>
          <hr class="my-2">
          <div class="d-flex justify-content-between">
            <h6 class="fw-bold">Total</h6>
            <h6 class="fw-bold text-success">₹{{ total_amount }}</h6>
          </div>
        </div>

        <div class="mt-3">
          <small class="text-muted d-block">
            <i class="bi bi-info-circle me-1"></i>
            By proceeding, you agree to our <a href="#" class="text-decoration-none">Terms & Conditions</a>.
          </small>
        </div>
      </div>
    </div>

    <!-- Shipping Address -->
    <div class="col-lg-5 offset-lg-1">
      <div class="card border-0 shadow-sm p-3">
        <h4 class="fw-semibold mb-3"><i class="bi bi-geo-alt me-2"></i>Shipping Address</h4>
        <hr>

        <form method="post" action="{% url 'payment' %}">
          {% csrf_token %}
          {% for customer in customers %}
          <div class="form-check mb-3">
            <input class="form-check-input" type="radio" name="customer_id"
                  id="address{{ forloop.counter }}" value="{{ customer.id }}" required>
            <label class="form-check-label" for="address{{ forloop.counter }}">
              <div class="card border-0 bg-light shadow-sm p-3">
                <h6 class="mb-1 fw-semibold">{{ customer.name }}</h6>
                <small class="text-muted d-block">
                  {{ customer.locality }}, {{ customer.city }} <br>
                  {{ customer.state }} - {{ customer.zipcode }}
                </small>
              </div>
            </label>
          </div>
          {% endfor %}

          <div class="text-end mt-4">
            <button type="submit" class="btn btn-dark px-5 py-2 fw-semibold">
              Continue <i class="bi bi-arrow-right-circle ms-2"></i>
            </button>
          </div>
        </form>



      </div>
    </div>

  </div>
</div>
{% endblock main-content %}
